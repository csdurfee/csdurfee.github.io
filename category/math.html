<!DOCTYPE html>
<html lang="english">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>mathletix | articles in the "math" category</title>
    <link rel="shortcut icon" type="image/png" href="/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="mathletix Full Atom Feed" />
    <link href="/feeds/math.atom.xml" type="application/atom+xml" rel="alternate" title="mathletix Categories Atom Feed" />
    <link rel="stylesheet" href="/theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="/theme/css/pygments.css" type="text/css" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="casey durfee" />
</head>
<body>
    <header>
        <nav style="overflow: hidden;">
            <ul>

                <li class="ephemeral selected"><a href="/category/math.html">math</a></li>
                <li><a href="/">Home</a></li>
                <li><a href="/pages/aboutbest-of.html">About/Best Of</a></li>
            </ul>
        </nav>
        <div class="header_box" style="height: 50px">
        <h1><a href="/">
            <image src='' class="avatar" width="50px" /><span class="site_title">mathletix</span>
            </a></h1></div>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">Sep 23, 2025</h4>

            <article class="post">
                <h2 class="title">
                    <a href="/primes-and-self-similarity.html" rel="bookmark" title="Permanent Link to &quot;Primes and self-similarity&quot;">Primes and self-similarity</a>
                </h2>

                
                

                <p><a href="https://www.youtube.com/watch?v=ncmIlVdL8po" target="_blank"><img alt="John Hollenbeck &amp; NDR Big Band, &quot;Entitlement&quot;" src="https://img.youtube.com/vi/ncmIlVdL8po/0.jpg"></a></p>
<p>Song: <a href="https://www.youtube.com/watch?v=ncmIlVdL8po" target="_blank">John Hollenbeck &amp; NDR Big Band, "Entitlement"</a></p>
<p>I've been messing around with prime numbers, because there are several places where they intersect with both random walks and the arcsine distribution.  It's going to take a while to finally tie that bow, though.</p>
<p>So it's a quick one this week: a kinda-cool story, and a kinda-cool graph.</p>
<h3>Random Primes</h3>
<p>The prime numbers are simple to find, but not easy. They're not randomly distributed, but it's hard to come up with simple ways to find them, and they act like random numbers in certain ways.  Why is 47 prime and 57 non-prime?</p>
<p>To find the primes, we can write down every number from, say, 1 to 1000. Then we cross out 2, and every number divisible by 2 (4, 6, 8, etc.). Repeat that with 3 (6, 9, 12, etc.), and so on. The numbers left behind are prime. This is the famous <a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">Sieve of Eratosthenes</a> -- it's a tedious way to find prime numbers, but it's by far the easiest to understand.</p>
<p>The sieve gave mathematician David Hawkins an idea [1]: what about doing that same process, but randomly?  For each number, flip a coin, if it comes up heads, cross the number out. That will eliminate half of the numbers on the first pass. Take the lowest number <code>k</code> that remains and eliminate each of the remaining numbers with probability <code>1/k</code>. Say it's 4. For each remaining number, we flip a 4 sided die and if it comes up 4, we cross it out. </p>
<p>If we go through all the numbers, what's left over won't look like real prime numbers -- there should be as many even fake primes as odd ones, for starters. But the remaining numbers will be as sparse as the actual prime numbers. As the sample size N heads to infinity, the chances of a random number being a real prime, and being a fake prime, are the same -- <code>1/log(N)</code>.</p>
<p>This is a brilliant way to figure out what we know about prime numbers are due to their density, and what are due to other, seemingly more magical (but still non-random) factors. </p>
<p>Several characteristics of real primes apply to the random primes. And tantalizingly, things that can't be proven about real primes can be proven about the fake ones. It's been conjectured that there are infinitely many pairs of twin primes -- primes that are separated by 2 numbers. An example would be 5 and 7, or 11 and 13. It makes sense for a lot of reasons that there should be an infinite number of twin primes.  But mathematicians have been trying to prove it for over 150 years, without success.</p>
<p>Random primes can be odd or even, so the analogy to twin primes would be two random primes that are only one apart, say 5 and 6. It's relatively simple to prove that there are an infinite number of random twin primes [2]. That could easily be fool's gold -- treating the primes like they're randomly distributed gives mathematicians a whole toolbox of statistical techniques to use on them, but they're not random, or arbitrary. They're perfectly logical, and yet still inscrutible, hidden in plain sight.</p>
<h3>Largest prime factors of composite numbers</h3>
<p>I was intrigued by the largest prime factor of composite (non-prime) numbers. Are there any patterns?</p>
<p>As background, every number can be split into a unique set of prime factors. For instance, the number 24 can be factored into <code>24 = 8 * 3 = 2 * 2 * 2 * 3</code>. Let's say we knock off the biggest prime factor. We get: <code>2 * 2 * 2 = 8</code>. The raw numbers rapidly get too big, so I looked at the log of the ratio</p>
<p><img alt="/img/logratios100k.png" src="/img/logratios100k.png"></p>
<p>The red curve is the distribution of the first 100,000 composite numbers, the orange is the next 100,000 composite numbers, and so on. </p>
<p>What if we bump up an order of magnitude? This time, the red curve is the first million composite numbers, the orange is the next million, and so on. Here's what that looks like:</p>
<p><img alt="/img/logratios1M.png" src="/img/logratios1M.png"></p>
<p>Pretty much the same graph, right? The X axis is different, but the shapes are very similar to the first one. </p>
<p>Let's go another order of magnitude up. The first 10,000,000 versus the next 10,000,000, and so on?</p>
<p><img alt="/img/logratios10M.png" src="/img/logratios10M.png"></p>
<p>We get the same basic shapes again! The self-similarity is kinda cool. It may be possible to come up with some function for the distribution for this quantity. </p>
<h3>The perils of interpolation</h3>
<p>These graphs are flawed. I'm generating these graphs using Kernel Density Estimation, a technique for visualizing the density of data. Histograms, another common way, can be misleading. The choice of bin size can radically alter what the histogram looks like.</p>
<p>But KDE can also be misleading. These graphs make it look like the curve starts at zero.  That's not true. The minimum possible value happens when a number is of the form <code>2*p</code>, where p is a prime -- the value will be <code>log(2)</code>, about .693.</p>
<p>This data is actually way <em>chunkier</em> than KDE is treating it.  Every point of data is the log of a whole number. So there aren't that many unique values. For instance, between 0 and 1 on the X axis, there's only one possible value -- <code>log(2)</code>. Between 1 and 3, there are only 18 possible values, <code>log(2)</code> thru <code>log(19)</code> -- those being the only integers with a <code>log</code> less than 3 and greater than 1.</p>
<p>This makes it hard to visualize the data accurately. There are too many possible values to display each one individually, but not enough for KDE's smoothing to be appropriate.</p>
<p>The <em>kernel</em> in Kernel Density Estimation is the algorithm used to smooth the data --  it's basically a moving average that assumes something about the distribution of the data. People usually use the Gaussian kernel, which treats the data like a normal distribution -- smooth and bell curvy. A better choice for chunky data is the <em>tophat</em> kernel, which treats the space between points like a uniform distribution -- in other words, a flat line. If the sparseness of the data on the X axis were due to a small sample size, the tophat kernel would display plateaus that aren't in the real data. But here, I calculated data for the first 100 Million numbers, so there's no lack of data. The sparseness of the data is by construction. <code>log(2)</code> will be the only value between 0 and 1, no matter how many numbers we go up to. So the left side of the graph should look fairly chunky.</p>
<p>The tophat kernel does a much better job of conveying the non-smoothness of the distribution:</p>
<p><img alt="/img/tophat.png" src="/img/tophat.png"></p>
<h3>References</h3>
<p>[1] https://chance.dartmouth.edu/chance_news/recent_news/chance_primes_chapter2.html</p>
<p>[2] for sufficiently large values of <em>simple</em></p>
<p>[3] https://scikit-learn.org/stable/auto_examples/neighbors/plot_kde_1d.html</p>
<p>[4] https://en.wikipedia.org/wiki/Kernel_density_estimation</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="/primes-and-self-similarity.html">posted at 10:20</a>
                    &nbsp;&middot;&nbsp;<a href="/category/math.html" rel="tag">math</a>
                    &nbsp;&middot;
                    &nbsp;<a href="/tag/number-theory.html" class="tags">number theory</a>
                    &nbsp;<a href="/tag/machine-learning.html" class="tags">machine learning</a>
                    &nbsp;<a href="/tag/some-educational-value.html" class="tags">some educational value</a>
                </div>
            </article>            <h4 class="date">Jul 31, 2025</h4>

            <article class="post">
                <h2 class="title">
                    <a href="/harmonics.html" rel="bookmark" title="Permanent Link to &quot;Harmonics&quot;">Harmonics</a>
                </h2>

                
                

                <p><a href="https://www.youtube.com/watch?v=5Ocq8UlLuuw" target="_blank"><img alt="Donna Summer and Giorgio Moroder, &quot;I Feel Love&quot; (Patrick Cowley Remix)" src="https://img.youtube.com/vi/5Ocq8UlLuuw/0.jpg"></a></p>
<p>Song: <a href="https://www.youtube.com/watch?v=5Ocq8UlLuuw" target="_blank">Donna Summer and Giorgio Moroder, "I Feel Love" (Patrick Cowley Remix)</a></p>
<p>Notebook: <a href="https://github.com/csdurfee/csdurfee.github.io/blob/main/harmonics.ipynb">https://github.com/csdurfee/csdurfee.github.io/blob/main/harmonics.ipynb</a></p>
<p>I was gonna do random walks this week, but the thing about random walks is you don't know where you're gonna end up, and I ended up back at last week's topic again. </p>
<p>Last time, we saw that the sine wave, sawtooth wave and square wave produced very different distributions.</p>
<p>All three waveforms are used in electronic music, and they all have different acoustic properties. A sine wave sounds like a "boop" -- think of the sound they play to censor someone who says a swear word on the TV.  That's a sine wave with a frequency of 1000Hz. Sawtooth waves are extremely buzzy. A square wave has, ironically, kind of a round sound, at least as far as how it gets used in electronic music.  A good example is the bass line to this week's song. </p>
<p>It's not a pure square wave, and it's rare to ever hear pure sawtooth or square waves because they're harsh on the ears. Usually multiple waveforms are combined together and then passed through various filters and effects -- in other words, synthesized. </p>
<p>Pretty much every sound you've ever heard is a mix of different frequencies. Only sine waves are truly pure, just a single frequency. I tried looking for an actual musical instrument that produces pure sine waves, and the closest thing (according to the internet, at least) is a tuning fork. </p>
<p>Any other musical instrument, or human voice, or backfiring car, will produce overtones. There's one note that is perceived as the <em>fundamental frequency</em>, but every sound is kind of like a little chord when the overtones are included. </p>
<p>For musical instruments, the loudest overtones are generally at frequencies that are a multiple of the original frequency. These overtones are called <em>harmonics</em>.</p>
<p>For instance, if I play a note at 400 Hz on a guitar, it will also produce harmonics at 800 Hz (2x the fundamental frequency), 1200 Hz (3x), 1600 Hz (4x), 2000 Hz (5x), and so on. This corresponds to the <a href="https://en.wikipedia.org/wiki/Harmonic_series_(mathematics)">harmonic series in mathematics</a>. It's the sum of the ratios of the wavelengths of the harmonics to the fundamental frequency: 1 + 1/2 + 1/3 + 1/4 + 1/5 + ...</p>
<h3>The clarinet is the squarest instrument</h3>
<p>I played the clarinet in grade school and I am the biggest dork on the planet, so it's certainly metaphorically true. But it's also literally true.</p>
<p>There's a lot that goes into exactly which overtones get produced by a physical instrument, but most instruments put out the whole series of harmonics. <a href="https://newt.phys.unsw.edu.au/jw/clarinetacoustics.html#harmonics">The clarinet is different</a>. Because of a clarinet's physical shape, it pretty much only produces odd harmonics. So, in our example, 400 Hz, 1200 Hz, 2000 Hz, etc.</p>
<p>The square wave is like an idealized version of a clarinet -- it also only puts out odd harmonics. This is a result of how a square wave is constructed. In the real world, they're formed out of a combination of sine waves. Which sine waves? You guessed it -- the ones that correspond to the odd harmonic frequencies.</p>
<p>Here's the fundamental frequency combined with the 3rd harmonic:</p>
<p><img alt="/img/square3.png" src="/img/square3.png"></p>
<p>It already looks a bit square-wavey. Additional harmonics make the square parts a bit more square.  Here's what it looks like going up to the 19th harmonic:</p>
<p><img alt="/img/square21.png" src="/img/square21.png"></p>
<p>In the real world, we can only add a finite number of harmonics, but if we could combine an infinite number of them, we would get the ideal square wave. This is called the <a href="https://en.wikipedia.org/wiki/Fourier_series">Fourier series</a> of the square wave.</p>
<p>Here's an illustration to help show how the square wave gets built up:</p>
<p><img alt="/img/square-buildup.png" src="/img/square-buildup.png"></p>
<p>The red wave is the fundamental frequency. The orange square-ish wave is the result of combining the other colored waves with the red wave.</p>
<p>The sum normally would be scaled up a bit (multiplied by 4/pi), but it's easier without the scaling to see how the other waves sort of hammer the fundamental frequency into the shape of the square wave. At some points they are pushing it up, and other points pulling it down.</p>
<p>Perhaps this graph makes it clearer. The red is the fundamental, the yellow is the sum of all the other harmonics, and the orange is the combination of the two:</p>
<p><img alt="/img/combine-harmonics-square.png" src="/img/combine-harmonics-square.png"></p>
<p>Where the yellow is above the X axis, it's pulling the fundamental frequency up, and where it's below, it's pulling the fundamental down.</p>
<h3>The sawtooth</h3>
<p>A sawtooth wave is what you get when you combine all the harmonics, odd and even. Like the square wave, it starts to take its basic shape right away. Here's the fundamental plus the second harmonic:</p>
<p><img alt="/img/sawtooth2.png" src="/img/sawtooth2.png"></p>
<p>And here it is going all the way up to the 10th harmonic:</p>
<p><img alt="/img/sawtooth10.png" src="/img/sawtooth10.png"></p>
<p>Red fundamental plus yellow harmonics produce the orange sawtooth wave:</p>
<p><img alt="/img/combine-harmonics-saw.png" src="/img/combine-harmonics-saw.png"></p>
<p>Last time, I talked about the sawtooth wave producing a uniform distribution of amplitudes -- the butter gets spread evenly over the toast. The graph above isn't a very smooth stroke of butter. It's not steadily decreasing, particularly at the ends. Here's what the distribution looks like at this point:</p>
<p><img alt="/img/sawtooth10-amps.png" src="/img/sawtooth10-amps.png"></p>
<p>With an infinite series of harmonics, that graph will even out to a uniform distribution</p>
<h3>Getting even</h3>
<p>What about only the even harmonics? Is that a thing? Not in the natural world as far as I know, but there's nothing stopping me from making one. (It wouldn't be the worst musical crime I've ever committed.)</p>
<p>Here's what a combo of just the even harmonics looks like:</p>
<p><img alt="/img/even-harmonics.png" src="/img/even-harmonics.png"></p>
<p>Thanks to a little code from the pygame project, it's easy to turn that waveform into a sound file. It sounds like an angry computer beep, with a little flutter mixed in.</p>
<p><a href="/audio/evens_clean.wav" target="_blank">Here's an audio sample</a></p>
<h3>In my prime</h3>
<p>The <a href="https://mathworld.wolfram.com/HarmonicSeriesofPrimes.html">harmonic series of primes</a> is what it sounds like: the harmonic series, but just the prime numbers: 1 + 1/2 + 1/3 + 1/5 + 1/7 + 1/11 + 1/13 + ....</p>
<p>Although it's important in mathematics, I don't have a good musical reason to do this. But if you can throw the prime numbers into something, you gotta do it.</p>
<p>As a sound, I kinda like it. It's nice and throaty. <a href="/audio/primes.wav" target="_blank">Here's what it sounds like.</a></p>
<p>It doesn't really sound like a sawtooth wave or a square wave to me. Here's the waveform:</p>
<p><img alt="/img/prime-waveform.png" src="/img/prime-waveform.png"></p>
<p>Here's what the distribution of amplitudes looks like:</p>
<p><img alt="/img/prime-amp.png" src="/img/prime-amp.png"></p>
<h3>Dissonance</h3>
<p>Some of the overtones of the harmonic series don't correspond with the 12 notes of the modern western musical scale (called 12 tone equal temprament, or 12TET). The first 4 harmonics of the series are nice and clean, but after that they get weird. Each harmonic in the series is smaller in amplitude than the previous one, so it has less of an effect on the shape of the final wave. So the dissonance is there, but it's way in the background.</p>
<p>The prime number bloop I made above should be extra <em>weird</em>. The 2nd and 3rd harmonics are included, so those will sound nice, but after that they are at least a little off the standard western scale.</p>
<p>Say we're playing the <em>prime bloop</em> at A4 (the standard pitch used for tuning).  Here's how the harmonics work out. A cent is 1% of a semitone. So a note that is off by 50 cents is right between two notes on the 12 tone scale.</p>
<table>
<thead>
<tr>
<th>harmonic #</th>
<th>frequency</th>
<th>pitch</th>
<th>error</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>440 Hz</td>
<td>A4</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>880 Hz</td>
<td>A5</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>1320</td>
<td>E6</td>
<td>+2 cents</td>
</tr>
<tr>
<td>5</td>
<td>2200</td>
<td>C#7</td>
<td>-14 cents</td>
</tr>
<tr>
<td>7</td>
<td>3080</td>
<td>G7</td>
<td>+31 cents</td>
</tr>
<tr>
<td>11</td>
<td>4840</td>
<td>D#8</td>
<td>-49 cents</td>
</tr>
<tr>
<td>13</td>
<td>5720</td>
<td>F8</td>
<td>+41 cents</td>
</tr>
<tr>
<td>17</td>
<td>7480</td>
<td>A#8</td>
<td>+5 cents</td>
</tr>
</tbody>
</table>
<p>(Note the 3rd harmonic, E6, is a little <em>off</em> in 12TET, despite being a <em>perfect fifth</em> -- an exact 3:2 ratio with the A5.)</p>
<h3>Harmonics aren't everything</h3>
<p>While it's true that any audio can be decomposed into a bunch of sine waves, the fundamental frequency and the harmonics aren't really what gives an instrument its unique timbre. It's hundreds or thousands of tiny overtones that don't line up with the harmonics.</p>
<p>Here are the spectra of two different piano sounds playing at 220 Hz. One is a somewhat fake piano sound (Fruity DX10), the other a natural, rich sounding one (LABS Soft Piano, which you might've heard before if you listen to those "Lofi Hip Hop Beats to Doomscroll/Not Study To" playlists). Can you guess which is which?</p>
<p><img alt="/img/real-piano.png" src="/img/real-piano.png"></p>
<p><img alt="/img/fake-piano.png" src="/img/fake-piano.png"></p>
<p>The answer may surprise you. I mean, it can't be that surprising since there are only 2 options. But I'd probably get it wrong, if I didn't already know which is which.</p>
<h3>Sources/Notes</h3>
<p><a href="https://www.phys.unsw.edu.au/music/">This website from UNSW was invaluable</a>, particularly <a href="https://newt.phys.unsw.edu.au/jw/harmonics.html">https://newt.phys.unsw.edu.au/jw/harmonics.html</a></p>
<p>Code used to generate the audio: <a href="https://stackoverflow.com/questions/56592522/python-simple-audio-tone-generator">https://stackoverflow.com/questions/56592522/python-simple-audio-tone-generator</a></p>
<p>"The internet" claiming the sound of a tuning fork is a sine wave here (no citation given): <a href="https://en.wikipedia.org/wiki/Tuning_fork#Description">https://en.wikipedia.org/wiki/Tuning_fork#Description</a>.</p>
<p>There are many good videos on Youtube about 12TET and Just Intonation, by people who know more about music than me. Here's one from David Bennett: <a href="https://www.youtube.com/watch?v=7JhVcGtT8z4">https://www.youtube.com/watch?v=7JhVcGtT8z4</a></p>
                <div class="clear"></div>

                <div class="info">
                    <a href="/harmonics.html">posted at 10:20</a>
                    &nbsp;&middot;&nbsp;<a href="/category/math.html" rel="tag">math</a>
                    &nbsp;&middot;
                    &nbsp;<a href="/tag/some-educational-value.html" class="tags">some educational value</a>
                </div>
            </article>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/tcarwash/blue-penguin-dark">Blue Penguin Dark</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>